library(readr)
train <- read_csv("C:/Kaggle/Titanic/Titanic/Data/train.csv",
col_types = cols(Parch = col_character(),
PassengerId = col_character(), Pclass = col_character(),
SibSp = col_character(), Survived = col_character()))
View(train)
library(readr)
test <- read_csv("C:/Kaggle/Titanic/Titanic/Data/test.csv",
col_types = cols(Parch = col_character(),
PassengerId = col_character(), Pclass = col_character(),
SibSp = col_character()))
View(test)
?step
?glm
model<- glm(survved~.,data=train,family =binomial)
model<- glm(survived~.,data=train,family =binomial)
model<- glm(Survived~.,data=train,family =binomial)
as.integer(train$Survived)
train$Survived<-as.integer(train$Survived)
model<- glm(Survived~.,data=train,family =binomial)
summary(model)
model<- glm(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
train$Survived<-as.integer(train$Survived)
model<- glm(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
summary(model)
model<- step(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
?step
model<- step(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
stepModel<-step(model)
stepModel<-step(model)
summary(model)
predictions<-predict(model,newdata = test)
train$SibSp
test$SibSp
train$SibSp<-as.integer(train$Sibsp)
library(readr)
train <- read_csv("C:/Kaggle/Titanic/Titanic/Data/train.csv")
View(train)
library(readr)
test <- read_csv("C:/Kaggle/Titanic/Titanic/Data/test.csv")
View(test)
model<- step(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
model<- glm(Survived~Pclass+Sex+Age+SibSp+Parch+Ticket+Fare+Cabin+Embarked,data=train,family =binomial)
summary(model)
step(model)
predictions<-predict(model,newdata = test)
model<- glm(Survived~Pclass+Sex+Age+SibSp+Parch+Fare+Embarked,data=train,family =binomial)
summary(model)
step(model)
predictions<-predict(model,newdata = test)
names(predictions)
predictions
class(predictions)
names(predictions)
predictions_details<-select(predictions,predictions$label,predictions$prediction)
?select
test$predictions<-predict(model,newdata = test)
View(train)
View(test)
train_MSE = mean(model$residuals^2)
View(test)
View(train)
is.na(train$Sex)
train$Gender <- ifelse(data$Sex == "male",1,0)
train$Gender <- ifelse(train$Sex == "male",1,0)
test$Gender <- ifelse(test$Sex == "male",1,0)
train$Age[is.na(train$Age)] <- mean(train$Age, na.rm = TRUE)
model<- glm(Survived~Pclass+Gender+Age+SibSp+Parch+Fare+Embarked,data=train,family =binomial)
rm(model)
logistic.model<- glm(Survived~Pclass+Gender+Age+SibSp+Parch+Fare+Embarked,data=train,family =binomial)
summary(logistic.model)
step.model<-step(logistic.model)
summary(step.model)
logistic_MSE = mean(model$residuals^2)
logistic_MSE = mean(logistic.model$residuals^2)
step_MSE = mean(step.model$residuals^2)
rm(train_MSE)
test_predictions = predict(step.model, test, type = “response”)
test_predictions = predict(step.model, test)
test_predictions
test$predictions<-predict(step.model,newdata = test)
train$training_predictions <- predict(step.model)
length(is.na(train$Embarked))
length(is.na(train$Embarked=="T"))
length(is.na(train$Embarked)=="T")
is.na(train$Embarked)=="T"
is.na(train$Embarked)
train$Embarked_C = ifelse(train$Embarked == "C", 1, 0)
train$Embarked_Q = ifelse(train$Embarked == "Q", 1, 0)
logistic.model<- glm(Survived~Pclass+Gender+Age+SibSp+Parch+Fare+Embarked_C+Embarked_Q,data=train,family =binomial)
summary(logistic.model)
step.model<-step(logistic.model)
logistic_MSE = mean(logistic.model$residuals^2)
step_MSE = mean(step.model$residuals^2)
test_predictions = predict(step.model, test)
test$predictions<-predict(step.model,newdata = test)
test$Embarked_C = ifelse(test$Embarked == "C", 1, 0)
test$Embarked_Q = ifelse(test$Embarked == "Q", 1, 0)
test_predictions = predict(step.model, test)
test$predictions<-predict(step.model,newdata = test)
train$pclass <-factor(train$pclass,levels = c(3, 2, 1), ordered = TRUE)
test$pclass <-factor(test$pclass,levels = c(3, 2, 1), ordered = TRUE)
train$Gender <- ifelse(train$Sex == "male",1,0)
test$Gender <- ifelse(test$Sex == "male",1,0)
train$Age[is.na(train$Age)] <- mean(train$Age, na.rm = TRUE)
train$Embarked_C = ifelse(train$Embarked == "C", 1, 0)
train$Embarked_Q = ifelse(train$Embarked == "Q", 1, 0)
test$Embarked_C = ifelse(test$Embarked == "C", 1, 0)
test$Embarked_Q = ifelse(test$Embarked == "Q", 1, 0)
#predicted model
logistic.model<- glm(Survived~Pclass+Gender+Age+SibSp+Parch+Fare+Embarked_C+Embarked_Q,data=train,family =binomial)
summary(logistic.model)
step.model<-step(logistic.model)
logistic_MSE = mean(logistic.model$residuals^2)
step_MSE = mean(step.model$residuals^2)
#prediction
test_predictions = predict(step.model, test)
test$predictions<-predict(step.model,newdata = test)
View(train)
train$predictions<-predict(step.model,newdata = train)
View(train)
View(test)
train$pclass <-factor(train$pclass,levels = c(3, 2, 1), ordered = TRUE)
test$pclass <-factor(test$pclass,levels = c(3, 2, 1), ordered = TRUE)
train$Gender <- ifelse(train$Sex == "male",1,0)
test$Gender <- ifelse(test$Sex == "male",1,0)
train$Age[is.na(train$Age)] <- mean(train$Age, na.rm = TRUE)
test$Age[is.na(test$Age)] <- mean(test$Age, na.rm = TRUE)
train$Embarked_C = ifelse(train$Embarked == "C", 1, 0)
train$Embarked_Q = ifelse(train$Embarked == "Q", 1, 0)
test$Embarked_C = ifelse(test$Embarked == "C", 1, 0)
test$Embarked_Q = ifelse(test$Embarked == "Q", 1, 0)
#predicted model
logistic.model<- glm(Survived~Pclass+Gender+Age+SibSp+Parch+Fare+Embarked_C+Embarked_Q,data=train,family =binomial)
summary(logistic.model)
step.model<-step(logistic.model)
logistic_MSE = mean(logistic.model$residuals^2)
step_MSE = mean(step.model$residuals^2)
#prediction
test_predictions = predict(step.model, test)
test$predictions<-predict(step.model,newdata = test)
View(test)
View(train)
test$exp_predictions<-exp(test$predictions)
train$exp_predictions<-exp(train$predictions)
View(train)
train$log_predictions<-log(train$predictions)
test_predictions = predict(step.model, test, type = "response")
test$predictions<-predict(step.model,newdata = test,type = "response")
View(test)
train$predictions<-predict(step.model,newdata = train,type = "response")
test$survival = ifelse(test$predictions > 0.5, 1, 0)
?subset
submission <- cbind(test$PassengerId, test$survival)
View(submission)
submission <- test["PassengerId","survival"]
submission
submission <- cbind(test$PassengerId, test$survival)
colnames(submission) <- c("PassengerId", "Survived")
write.csv(submission, file = "C:\Kaggle\Titanic\Titanic\Submission/submission_steplogistic.csv",row.names = FALSE)
write.csv(submission, file = "C:/Kaggle/Titanic/Titanic/Submission/submission_steplogistic.csv",row.names = FALSE)
library(readr)
submission_steplogistic <- read_csv("C:/Kaggle/Titanic/Titanic/Submission/submission_steplogistic.csv")
View(submission_steplogistic)
